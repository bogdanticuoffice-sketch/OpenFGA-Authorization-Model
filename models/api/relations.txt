# API authorization example tuples
# Format: object#relation@user

application:myapp#owner@user:alice
application:myapp#admin@user:bob
application:myapp#member@user:charlie

api_key:key_1#application@application:myapp
api_key:key_1#owner@user:alice
api_key:key_1#created_by@user:alice

api_key:key_2#application@application:myapp
api_key:key_2#owner@user:bob
api_key:key_2#created_by@user:alice

# GET /users — public endpoint
api_endpoint:get_users#application@application:myapp
api_endpoint:get_users#owner@user:alice
api_endpoint:get_users#public_viewer@user:*
api_endpoint:get_users#authenticated_viewer@user:alice
api_endpoint:get_users#authenticated_viewer@user:bob
api_endpoint:get_users#authorized_caller@user:alice
api_endpoint:get_users#authorized_caller@user:bob

# POST /users — authenticated + authorized only
api_endpoint:create_user#application@application:myapp
api_endpoint:create_user#owner@user:alice
api_endpoint:create_user#authenticated_viewer@user:alice
api_endpoint:create_user#authorized_caller@user:alice

# DELETE /users — admin only (alice is admin via application, bob is not)
api_endpoint:delete_user#application@application:myapp
api_endpoint:delete_user#owner@user:alice
api_endpoint:delete_user#authorized_caller@user:alice

api_scope:users_read#application@application:myapp
api_scope:users_read#granted_to@user:alice
api_scope:users_read#granted_to@user:bob

api_scope:users_write#application@application:myapp
api_scope:users_write#granted_to@user:alice

service_account:ci_account#application@application:myapp
service_account:ci_account#owner@user:alice
